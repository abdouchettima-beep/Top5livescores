<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚öΩ Live Football Scores</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'Roboto', sans-serif; background:#121212; color:#fff; }

  header {
    background: linear-gradient(90deg,#1e3c72,#2a5298);
    text-align:center;
    font-size:1.5em;
    font-weight:700;
    padding:15px;
    position: sticky;
    top:0;
    z-index:100;
  }

  nav { 
    display:flex; 
    justify-content:center; 
    flex-wrap:wrap; 
    gap:5px; 
    margin:10px;
  }
  
  nav button {
    flex: 1 1 100px;
    padding:12px 8px;
    border:none;
    border-radius:8px;
    background:#222;
    color:#fff;
    font-weight:500;
    font-size:0.8em;
    cursor:pointer;
    transition:0.3s;
  }
  
  nav button.active { 
    background:#1e90ff; 
  }

  .toggle-bar { 
    display:flex; 
    justify-content:center; 
    gap:10px; 
    margin:15px;
  }
  
  .toggle-bar button {
    padding:12px 20px;
    border:none;
    border-radius:8px;
    background:#222;
    color:#fff;
    font-weight:500;
    cursor:pointer;
    transition:0.3s;
  }
  
  .toggle-bar button.active { 
    background:#28a745; 
  }

  .section-title { 
    margin:20px 15px 10px; 
    font-size:1.3em; 
    font-weight:700; 
  }

  .match-box {
    background: #1f1f1f;
    margin:15px;
    padding:20px;
    border-radius:12px;
    border:1px solid #333;
  }

  .teams { 
    display:flex; 
    align-items:center; 
    justify-content:center; 
    gap:12px; 
    font-size:1.1em; 
    font-weight:600; 
    text-align:center;
    flex-wrap: wrap;
    margin-bottom: 15px;
  }
  
  .team-logo { width:35px; height:35px; object-fit:contain; }

  .score { 
    font-size:1.5em; 
    margin:10px 0; 
    padding:10px; 
    border-radius:8px; 
    font-weight:700; 
    text-align:center;
    background: #1e90ff;
  }
  
  .time { 
    font-size:1em; 
    margin:8px 0; 
    padding:8px 12px; 
    border-radius:6px; 
    text-align:center;
    background: #333;
  }
  
  .status { 
    font-size:0.9em; 
    margin-top:10px; 
    padding:8px 12px; 
    border-radius:6px; 
    font-weight:600; 
    text-align:center;
    background: #28a745;
  }

  .loading { 
    text-align: center; 
    padding: 20px; 
    margin: 20px;
    border-radius: 8px;
    background: #1e3c72;
    color: #fff;
  }
  
  .error { 
    text-align: center; 
    padding: 20px; 
    margin: 20px;
    border-radius: 8px;
    background: #dc3545;
    color: #fff;
  }
  
  .info { 
    text-align: center; 
    padding: 20px; 
    margin: 20px;
    border-radius: 8px;
    background: #444;
    color: #fff;
  }

  .hidden { display: none !important; }

  .proxy-selector {
    text-align: center;
    margin: 10px 15px;
    padding: 10px;
    background: #222;
    border-radius: 8px;
  }
  
  .proxy-selector select {
    background: #333;
    color: white;
    border: none;
    padding: 8px;
    border-radius: 5px;
    margin-left: 10px;
  }
</style>
</head>
<body>

<header>‚öΩ Live Football Scores</header>

<div class="proxy-selector">
  Proxy Server: 
  <select id="proxySelector">
    <option value="1">Proxy 1 (CORS Anywhere)</option>
    <option value="2">Proxy 2 (All Origins)</option>
    <option value="3">Proxy 3 (HTTP Proxy)</option>
    <option value="0">No Proxy (Direct)</option>
  </select>
</div>

<nav>
  <button data-league="39" class="active">Premier League</button>
  <button data-league="140">La Liga</button>
  <button data-league="135">Serie A</button>
  <button data-league="78">Bundesliga</button>
  <button data-league="61">Ligue 1</button>
</nav>

<div class="toggle-bar">
  <button id="liveBtn" class="active">Live Matches</button>
  <button id="upcomingBtn">Upcoming Matches</button>
</div>

<div id="status">
  <div class="loading" id="initialLoad">üöÄ Loading football scores...</div>
</div>

<div id="live-matches"></div>
<div id="upcoming-matches" class="hidden"></div>

<script>
// ===== CONFIGURATION =====
const API_KEY = "bcb3327d3417bafd64a44c4e92b40151"; // REPLACE THIS WITH YOUR ACTUAL KEY

// League configuration
const leagues = {
  39: { name: 'Premier League', color: '#1E90FF' },
  140: { name: 'La Liga', color: '#FF0000' },
  135: { name: 'Serie A', color: '#00C851' },
  78: { name: 'Bundesliga', color: '#FF8800' },
  61: { name: 'Ligue 1', color: '#800080' }
};

let currentLeagueId = 39;
let currentSection = 'live';
let currentProxy = '1';

// ===== PROXY CONFIGURATION =====
const proxies = {
  '1': 'https://cors-anywhere.herokuapp.com/',  // CORS Anywhere
  '2': 'https://api.allorigins.win/raw?url=',   // All Origins
  '3': 'https://corsproxy.io/?',                // CORS Proxy.io
  '0': ''                                       // No proxy
};

// ===== UTILITY FUNCTIONS =====
function showStatus(message, type = 'loading') {
  const statusDiv = document.getElementById('status');
  statusDiv.innerHTML = `<div class="${type}">${message}</div>`;
}

function hideStatus() {
  const statusDiv = document.getElementById('status');
  statusDiv.innerHTML = '';
}

// ===== ENHANCED FETCH FUNCTION =====
async function fetchWithRetry(url, options = {}, retries = 3) {
  const proxyUrl = proxies[currentProxy] + encodeURIComponent(url);
  const finalUrl = currentProxy !== '0' ? proxyUrl : url;
  
  console.log('Fetching URL:', finalUrl);
  
  for (let attempt = 1; attempt <= retries; attempt++) {
    try {
      showStatus(`üîÑ Loading... (Attempt ${attempt}/${retries})`, 'loading');
      
      const response = await fetch(finalUrl, {
        ...options,
        headers: {
          'x-rapidapi-key': API_KEY,
          'x-rapidapi-host': 'api-football-v1.p.rapidapi.com',
          ...options.headers
        }
      });
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      const data = await response.json();
      console.log('API Response:', data);
      
      return data;
      
    } catch (error) {
      console.error(`Attempt ${attempt} failed:`, error);
      
      if (attempt === retries) {
        throw new Error(`All proxies failed: ${error.message}`);
      }
      
      // Wait before retry
      await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
    }
  }
}

// ===== MATCH LOADING FUNCTIONS =====
async function loadLiveMatches(leagueId) {
  const liveDiv = document.getElementById('live-matches');
  
  try {
    const url = `https://api-football-v1.p.rapidapi.com/v3/fixtures?live=all&league=${leagueId}&season=2024`;
    const data = await fetchWithRetry(url);
    
    if (!data.response || data.response.length === 0) {
      liveDiv.innerHTML = `
        <div class="section-title">üî¥ Live Matches - ${leagues[leagueId].name}</div>
        <div class="info">No live matches at the moment. Check during match days!</div>
      `;
      hideStatus();
      return;
    }
    
    let matchesHTML = `<div class="section-title">üî¥ Live Matches - ${leagues[leagueId].name}</div>`;
    
    data.response.forEach(match => {
      const leagueColor = leagues[leagueId].color;
      const status = match.fixture.status.short;
      
      matchesHTML += `
        <div class="match-box">
          <div class="teams">
            <img class="team-logo" src="${match.teams.home.logo}" alt="${match.teams.home.name}" 
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAzNSAzNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjM1IiBoZWlnaHQ9IjM1IiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjE3LjUiIHk9IjIwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5IT01FPC90ZXh0Pgo8L3N2Zz4='"/>
            <span>${match.teams.home.name}</span>
            <span style="margin: 0 8px; color: #888;">vs</span>
            <img class="team-logo" src="${match.teams.away.logo}" alt="${match.teams.away.name}"
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAzNSAzNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjM1IiBoZWlnaHQ9IjM1IiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjE3LjUiIHk9IjIwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5BV0FZPC90ZXh0Pgo8L3N2Zz4='"/>
            <span>${match.teams.away.name}</span>
          </div>
          <div class="score" style="background: ${leagueColor}">
            ${match.goals.home ?? 0} - ${match.goals.away ?? 0}
          </div>
          <div class="time">‚è± ${match.fixture.status.elapsed || 0}' Minute</div>
          <div class="status" style="background: ${getStatusColor(status)}">
            ${getStatusText(status)}
          </div>
        </div>
      `;
    });
    
    liveDiv.innerHTML = matchesHTML;
    showStatus(`‚úÖ Loaded ${data.response.length} live matches`, 'info');
    setTimeout(hideStatus, 3000);
    
  } catch (error) {
    liveDiv.innerHTML = `
      <div class="section-title">üî¥ Live Matches - ${leagues[leagueId].name}</div>
      <div class="error">
        <strong>Failed to load live matches</strong><br>
        Error: ${error.message}<br>
        <small>Try switching proxy servers or check your API key</small>
      </div>
    `;
    showStatus('‚ùå Failed to load live matches', 'error');
  }
}

async function loadUpcomingMatches(leagueId) {
  const upcomingDiv = document.getElementById('upcoming-matches');
  
  try {
    const url = `https://api-football-v1.p.rapidapi.com/v3/fixtures?league=${leagueId}&season=2024&next=10`;
    const data = await fetchWithRetry(url);
    
    if (!data.response || data.response.length === 0) {
      upcomingDiv.innerHTML = `
        <div class="section-title">üìÖ Upcoming Matches - ${leagues[leagueId].name}</div>
        <div class="info">No upcoming matches found for this league</div>
      `;
      hideStatus();
      return;
    }
    
    let matchesHTML = `<div class="section-title">üìÖ Upcoming Matches - ${leagues[leagueId].name}</div>`;
    
    data.response.forEach(match => {
      const leagueColor = leagues[leagueId].color;
      const matchDate = new Date(match.fixture.date);
      const status = match.fixture.status.short;
      
      matchesHTML += `
        <div class="match-box">
          <div class="teams">
            <img class="team-logo" src="${match.teams.home.logo}" alt="${match.teams.home.name}"
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAzNSAzNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjM1IiBoZWlnaHQ9IjM1IiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjE3LjUiIHk9IjIwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5IT01FPC90ZXh0Pgo8L3N2Zz4='"/>
            <span>${match.teams.home.name}</span>
            <span style="margin: 0 8px; color: #888;">vs</span>
            <img class="team-logo" src="${match.teams.away.logo}" alt="${match.teams.away.name}"
                 onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzUiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAzNSAzNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjM1IiBoZWlnaHQ9IjM1IiBmaWxsPSIjMzMzIi8+Cjx0ZXh0IHg9IjE3LjUiIHk9IjIwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5BV0FZPC90ZXh0Pgo8L3N2Zz4='"/>
            <span>${match.teams.away.name}</span>
          </div>
          <div class="time" style="background: ${leagueColor}">
            üïê ${matchDate.toLocaleDateString()} at ${matchDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
          </div>
          <div class="status" style="background: ${getStatusColor(status)}">
            ${getStatusText(status)}
          </div>
        </div>
      `;
    });
    
    upcomingDiv.innerHTML = matchesHTML;
    showStatus(`‚úÖ Loaded ${data.response.length} upcoming matches`, 'info');
    setTimeout(hideStatus, 3000);
    
  } catch (error) {
    upcomingDiv.innerHTML = `
      <div class="section-title">üìÖ Upcoming Matches - ${leagues[leagueId].name}</div>
      <div class="error">
        <strong>Failed to load upcoming matches</strong><br>
        Error: ${error.message}<br>
        <small>Try switching proxy servers or check your API key</small>
      </div>
    `;
    showStatus('‚ùå Failed to load upcoming matches', 'error');
  }
}

// ===== HELPER FUNCTIONS =====
function getStatusColor(status) {
  const colors = {
    'NS': '#6c757d', '1H': '#28a745', '2H': '#28a745', 'HT': '#ffc107',
    'FT': '#dc3545', 'LIVE': '#28a745', 'PST': '#6c757d', 'CANC': '#6c757d'
  };
  return colors[status] || '#6c757d';
}

function getStatusText(status) {
  const texts = {
    'NS': 'Not Started', '1H': '1st Half', '2H': '2nd Half', 'HT': 'Half Time',
    'FT': 'Full Time', 'LIVE': 'Live', 'PST': 'Postponed', 'CANC': 'Canceled'
  };
  return texts[status] || status;
}

// ===== EVENT HANDLERS =====
function handleLeagueChange(leagueId, button) {
  document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
  button.classList.add('active');
  currentLeagueId = leagueId;
  refreshMatches();
}

function handleSectionChange(section, button) {
  document.querySelectorAll('.toggle-bar button').forEach(btn => btn.classList.remove('active'));
  button.classList.add('active');
  
  document.getElementById('live-matches').classList.toggle('hidden', section !== 'live');
  document.getElementById('upcoming-matches').classList.toggle('hidden', section !== 'upcoming');
  
  currentSection = section;
  refreshMatches();
}

function handleProxyChange(proxyId) {
  currentProxy = proxyId;
  showStatus('üîÑ Switching proxy server...', 'loading');
  refreshMatches();
}

function refreshMatches() {
  if (currentSection === 'live') {
    loadLiveMatches(currentLeagueId);
  } else {
    loadUpcomingMatches(currentLeagueId);
  }
}

// ===== INITIALIZATION =====
function initializeApp() {
  // Check if API key is set
  if (!API_KEY || API_KEY === "YOUR_REAL_API_KEY_HERE") {
    showStatus('‚ùå Please replace "YOUR_REAL_API_KEY_HERE" with your actual API key!', 'error');
    return;
  }
  
  // Add event listeners
  document.querySelectorAll('nav button').forEach(button => {
    button.addEventListener('click', () => {
      const leagueId = parseInt(button.getAttribute('data-league'));
      handleLeagueChange(leagueId, button);
    });
  });
  
  document.getElementById('liveBtn').addEventListener('click', () => {
    handleSectionChange('live', document.getElementById('liveBtn'));
  });
  
  document.getElementById('upcomingBtn').addEventListener('click', () => {
    handleSectionChange('upcoming', document.getElementById('upcomingBtn'));
  });
  
  document.getElementById('proxySelector').addEventListener('change', (e) => {
    handleProxyChange(e.target.value);
  });
  
  // Load initial data
  refreshMatches();
  
  // Auto-refresh live matches
  setInterval(() => {
    if (currentSection === 'live') {
      loadLiveMatches(currentLeagueId);
    }
  }, 30000);
}

// Start the app
document.addEventListener('DOMContentLoaded', initializeApp);
</script>
</body>
</html>
